# Отчет по лабораторной работе №4 по курсу "Объектно-ориентированное программирование"

---

Студент: Волков Алексей Александрович

Учебная группа: M8О-201БВ-24

Контакты: volckovl3sch@yandex.ru

Работа выполнена: 02.11.25

Преподаватель: Дзюба Дмитрий Владимирович

---

## Тема
Основы метапрограммирования
---

## Цель работы
1. Изучение основ работы с шаблонами (template) в C++
2. Изучение шаблонов умных указателей
3. Освоение концептов (concepts) для ограничения шаблонных параметров
4. Приобретение навыков создания шаблонных классов и функций
5. Изучение семантики перемещения и работы с умными указателями

---

## Задание 
### Вариант 14 - Фигуры вращения (Пятиугольник, Шестиугольник, Восьмиугольник)
Реализовать шаблонные классы геометрических фигур, наследующихся от базового шаблонного класса `Figure<T>`.

#### Требования к программе:
- Использование шаблонов для всех классов
- Применение концептов для ограничения скалярных типов
- Запрет на использование сырых указателей
- Хранение координат через `std::unique_ptr<Point<T>>`
- Хранение фигур в массиве через `std::shared_ptr<T[]>`
- Реализация семантики перемещения при изменении емкости массива
- Поддержка операций копирования, сравнения и приведения к double

#### Базовый абстрактный класс Figure<T>:
```cpp
template<Scalar T>
class Figure {
protected:
    Point<T> center;
    T radius;
    std::vector<std::unique_ptr<Point<T>>> points;
    // ... виртуальные методы
};
```
#### Конкретные классы фигур:
1) `Pentagon<T>` - правильный пятиугольник
2) `Hexagon<T>` - правильный шестиугольник
3) `Octagon<T>` - правильный восьмиугольник
4) `Array<T>` - шаблонный динамический массив
---

### Структура проекта
```txt
oop_lab4/
├── include/
│   ├── point.h              # Шаблонный класс Point<T> с concept
│   ├── figure.h             # Шаблонный базовый класс Figure<T>
│   ├── pentagon.h           # Шаблонный класс Pentagon<T>
│   ├── hexagon.h            # Шаблонный класс Hexagon<T>
│   ├── octagon.h            # Шаблонный класс Octagon<T>
│   └── array.h              # Шаблонный класс Array<T>
├── tests/
│   ├── main_test.cpp        # Запуск тестов
│   ├── point_test.cpp       # Тесты класса Point<T>
│   ├── figure_test.cpp      # Тесты класса Figure<T>
│   ├── pentagon_test.cpp    # Тесты класса Pentagon<T>
│   ├── hexagon_test.cpp     # Тесты класса Hexagon<T>
│   ├── octagon_test.cpp     # Тесты класса Octagon<T>
│   └── array_test.cpp       # Тесты класса Array<T>
├── main.cpp                 # Демонстрационная программа
└── CMakeLists.txt           # Система сборки
```

## Cборка и запуск

### Требования
    - Компилятор C++ с поддержкой стандарта C++20
    - CMake версии 3.14 или выше
    - Google Test для тестирования

### Инструкция по сборке:
```bash
# Сборка
mkdir build
cd build
cmake ..
make

# Запуск демонстрационной программы
./lab4_templates

# Запуск тестов
./tests
```
---
## Особенности реализации
#### Шаблоны и концепты
- **Point<T>** с концептом `Scalar` для ограничения арифметическими типами
- **Figure<T>** как шаблонный базовый класс для всех фигур
- Все реализации шаблонов размещены в заголовочных файлах
- Использование `this->` для доступа к унаследованным полям в шаблонах

#### Архитектура фигур
- Фигуры задаются через центр и радиус описанной окружности
- Автоматический расчет вершин в методе `calculatePoints()`
- Наследование от `Figure<T>` с реализацией чисто виртуальных методов
- **Универсальная** формула Гаусса для вычисления площади

#### Умные указатели и управление памятью
- `std::unique_ptr<Point<T>>` для хранения координат в фигурах
- `std::shared_ptr<T[]>` для хранения элементов в массиве
- Автоматическое управление памятью без явных **delete**

#### Шаблонный массив Array<T>
- Динамическое изменение емкости с семантикой перемещения
- Специализированные методы для работы с фигурами

#### Полиморфизм и операции
- Виртуальные методы для полиморфного поведения
- `operator double()` для приведения к площади
- Перегрузка операторов ввода/вывода через дружественные функции
- Сравнение фигур через перегруженный `operator==`

#### Тестирование
- **27 unit-тестов** покрывающих все шаблонные классы
- Проверка работы концептов и ограничений
- Демонстрация работы шаблона с разными типами хранимых данных

---
## Выводы
В ходе лабораторной работы были успешно освоены основы метапрограммирования в C++:

1. Созданы **шаблонные классы** с параметризацией по скалярным типам
2. **Применены концепты C++20** для ограничения шаблонных параметров
3. Освоены умные указатели - `unique_ptr` для исключительного владения и `shared_ptr` для разделяемого
4. **Реализована семантика перемещения** для эффективной работы с динамическими структурами

Работа продемонстрировала преимущества шаблонного программирования для создания универсального и типобезопасного кода, а также показала эффективность умных указателей для автоматического управления ресурсами.